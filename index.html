<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ ìƒì„±ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    .slide-group {
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 15px;
    }
    .slide-group h3 {
      margin-top: 0;
    }
    .image-input {
      display: block;
      margin-bottom: 5px;
    }
    #codeResult {
      white-space: pre-wrap;
      background: #f5f5f5;
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 30px;
      display: none;
      font-family: Consolas, monospace;
    }
    #convertBtn {
      margin-top: 20px;
      padding: 10px 20px;
    }

    .input-row {
      display: flex;
      flex-direction: row;
      align-items: center;
      column-gap: 100px; /* âœ… ì´ê²Œ í•µì‹¬: ê°„ê²© ë„“íˆê¸° */
      margin-bottom: 10px;
    }

    .input-area input {
      padding: 10px 12px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
      transition: border-color 0.3s, box-shadow 0.3s;
      height: 20px; /* âœ… ê³ ì • ë†’ì´ë¡œ ë‘ ì¸í’‹ ë™ì¼í•˜ê²Œ */
    }

    .input-area input:focus {
      border-color: #4A90E2;
      outline: none;
      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
    }

    .image-input {
      flex: 3; /* âœ… ì´ë¯¸ì§€ URL */
      min-width: 0;
    }

    .caption-input {
      flex: 7; /* âœ… ìº¡ì…˜ */
      min-width: 0;
    }

    .slide-count-buttons {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }

    .slide-count-buttons button {
      flex: 1;                          /* âœ… ìë™ ë„ˆë¹„ í™•ì¥ */
      min-width: 80px;                 /* âœ… ìµœì†Œ ë„ˆë¹„ ë³´ì¥ */
      max-width: 120px;                /* âœ… ë„ˆë¬´ ì»¤ì§€ì§€ ì•Šë„ë¡ */
      padding: 10px 16px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .slide-count-buttons button:hover {
      background-color: #eee;
      border-color: #999;
    }

    .slide-count-buttons button.active {
      background-color: #4A90E2;
      color: #fff;
      border-color: #4A90E2;
    }

    .slide-group button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      font-size: 15px;
      font-weight: 500;
      color: #000000;              /* âœ… ê¸€ììƒ‰ */
      background-color: #ececec;   /* âœ… ì—°í•œ íŒŒë€ ë°°ê²½ */
      border: none;                /* âœ… í…Œë‘ë¦¬ ì œê±° */
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease;
    }

    .slide-group button:hover {
      background-color: #d4d4d4;   /* âœ… í˜¸ë²„ ì‹œ ë°°ê²½ë§Œ ì‚´ì§ ì§„í•´ì§ */
    }

    #convertBtn {
      display: block;              /* âœ… ë¸”ë¡ ìš”ì†Œë¡œ ì „í™˜ */
      margin: 30px auto 0;         /* âœ… ì¤‘ì•™ ì •ë ¬ (auto) */
      width: 100%;                  /* âœ… ì „ì²´ì˜ 1/3 ë„ˆë¹„ */
      padding: 12px 16px;
      font-size: 16px;
      font-weight: 600;
      color: white;
      background-color: #f87c6e;   /* âœ… ë¹¨ê°„ ë°°ê²½ */
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.1s ease;
    }

    #convertBtn:hover {
      background-color: #C0392B;   /* âœ… ë” ì§„í•œ ë¹¨ê°• (í˜¸ë²„ ì‹œ) */
    }

    #convertBtn:active {
      transform: scale(0.97);      /* âœ… í´ë¦­ ì‹œ ì‚´ì§ ëˆŒë¦¼ íš¨ê³¼ */
    }

  </style>
</head>

<body>
  <h2 id="slideTitle" style="cursor:pointer">ğŸ“ ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ ìƒì„±ê¸°</h2>
    <div id="slideCountButtons" class="slide-count-buttons">
      <button data-count="1">1ê°œ</button>
      <button data-count="2">2ê°œ</button>
      <button data-count="3">3ê°œ</button>
      <button data-count="4">4ê°œ</button>
    </div>

  <div id="slideContainer"></div>

  <button id="convertBtn">ì½”ë“œ ë³€í™˜</button>

  <div id="codeResult"></div>
  <button id="copyBtn" style="display: none; margin-top: 10px;">ì „ì²´ ë³µì‚¬</button>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
    const slideCountButtons = document.querySelectorAll("#slideCountButtons button");

    slideCountButtons.forEach(button => {
      button.addEventListener("click", () => {
        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
        slideCountButtons.forEach(btn => btn.classList.remove("active"));
        button.classList.add("active");

        const count = parseInt(button.dataset.count);
        generateSlideGroups(count); // ì„ íƒëœ ìˆ«ìë§Œí¼ ìŠ¬ë¼ì´ë“œ ìƒì„±
        
      });
    });

    document.querySelector('button[data-count="1"]').classList.add("active");
      generateSlideGroups(1);
    });

    function generateSlideGroups(targetCount, reset = false) {
      const container = document.getElementById("slideContainer");

      // ì´ˆê¸°í™” ëª¨ë“œë©´ ì „ì²´ ë¹„ìš°ê¸°
      if (reset) {
        container.innerHTML = "";
      }

      const currentCount = container.querySelectorAll(".slide-group").length;

      // ìŠ¬ë¼ì´ë“œ ì¤„ì´ê¸°
      if (targetCount < currentCount) {
        for (let i = currentCount; i > targetCount; i--) {
          const group = document.getElementById(`slide-group-${i}`);
          if (group) group.remove();
        }
        return;
      }

      // ìŠ¬ë¼ì´ë“œ ì¶”ê°€
      for (let i = currentCount + 1; i <= targetCount; i++) {
        const groupDiv = document.createElement("div");
        groupDiv.className = "slide-group";
        groupDiv.id = `slide-group-${i}`;

        const title = document.createElement("h3");
        title.textContent = `ìŠ¬ë¼ì´ë“œ ${i}`;
        groupDiv.appendChild(title);

        const inputArea = document.createElement("div");
        inputArea.className = "input-area";

        for (let j = 0; j < 5; j++) {
          const wrapper = document.createElement("div");
          wrapper.className = "input-row";

          const urlInput = document.createElement("input");
          urlInput.type = "text";
          urlInput.placeholder = "ì´ë¯¸ì§€ URL ì…ë ¥";
          urlInput.className = "image-input";

          const captionInput = document.createElement("input");
          captionInput.type = "text";
          captionInput.placeholder = "ìº¡ì…˜ ì…ë ¥";
          captionInput.className = "caption-input";

          wrapper.appendChild(urlInput);
          wrapper.appendChild(captionInput);
          inputArea.appendChild(wrapper);
        }

        const addButton = document.createElement("button");
        addButton.textContent = "ì´ë¯¸ì§€ ì¶”ê°€";
        addButton.type = "button";
        addButton.onclick = () => {
          const wrapper = document.createElement("div");
          wrapper.className = "input-row";

          const newUrlInput = document.createElement("input");
          newUrlInput.type = "text";
          newUrlInput.placeholder = "ì´ë¯¸ì§€ URL ì…ë ¥";
          newUrlInput.className = "image-input";

          const newCaptionInput = document.createElement("input");
          newCaptionInput.type = "text";
          newCaptionInput.placeholder = "ìº¡ì…˜ ì…ë ¥";
          newCaptionInput.className = "caption-input";

          wrapper.appendChild(newUrlInput);
          wrapper.appendChild(newCaptionInput);
          inputArea.appendChild(wrapper);
        };

        groupDiv.appendChild(inputArea);
        groupDiv.appendChild(addButton);
        container.appendChild(groupDiv);
      }
    }


    document.getElementById("slideTitle").addEventListener("click", () => {
      generateSlideGroups(1, true); // ì´ˆê¸°í™” ëª¨ë“œë¡œ 1ê°œ ìŠ¬ë¼ì´ë“œ
    });

    generateSlideGroups(); // ì´ˆê¸°í™”

    convertBtn.addEventListener("click", () => {
        const activeButton = document.querySelector("#slideCountButtons button.active");
        const slideCount = parseInt(activeButton.dataset.count);
        let allSliderHTML = "";             // ê° ìŠ¬ë¼ì´ë“œ HTML ëˆ„ì 
        let allPreviewData = [];           // ê° ìŠ¬ë¼ì´ë“œì˜ image+caption ë°ì´í„° ë°°ì—´
        let allScriptHTML = "";
        let basicHTML = "";
        let lastHTML = "";
        
        for (let i = 1; i <= slideCount; i++) {
        const imageInputs = document.querySelectorAll(`#slide-group-${i} .image-input`);
        const captionInputs = document.querySelectorAll(`#slide-group-${i} .caption-input`);

        const imageUrls = Array.from(imageInputs).map(input => input.value.trim());
        const captions = Array.from(captionInputs).map(input => input.value.trim());

        const validImageUrls = imageUrls.filter(url => url !== "");
        const validImageCount = validImageUrls.length;

        const mainImage = imageUrls[0] || "ì˜ˆì‹œ ì´ë¯¸ì§€ ì£¼ì†Œ.jpg";
        const slideDataArray = [];
        let previewImagesHTML = "";

        imageUrls.forEach((url, idx) => {
            if (!url) return;
            const caption = captions[idx] || "ìº¡ì…˜ ì˜ˆì‹œì…ë‹ˆë‹¤.";
            slideDataArray.push(`{src: "${url}", caption: "${caption}"}`);
            previewImagesHTML += `<img src="${url}" alt="ë¯¸ë¦¬ë³´ê¸° ${idx + 1}" onclick="changeImage(${i}, ${idx})"${idx === 0 ? ' class="active-preview"' : ''}>\n`;
        });

        allPreviewData.push(`[${slideDataArray.join(",\n")}]`);

        basicHTML = `
          <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
            <style type="text/css">.slider-container {
              position: relative;
              width: 90%;
              max-width: 800px;
              margin: auto;
              overflow: hidden;
              background-color: black;
              margin-bottom: 40px;
            }

            .main-image {
              width: 100% !important;
              height: auto;
              object-fit: contain;
            }

            .slide-number {
              position: absolute;
              top: 10px;
              left: 10px;
              color: white;
              font-size: 18px;
              background-color: rgba(0, 0, 0, 0.5);
              padding: 5px 10px;
              border-radius: 5px;
            }

            .preview-images {
              display: flex;
              justify-content: center;
              margin-top: 10px;
              overflow-x: auto;
              padding-bottom: 10px;
            }

            .preview-images img {
              width: 80px;
              height: auto;
              margin: 0 5px;
              cursor: pointer;
              opacity: 0.6;
              transition: opacity 0.3s;
            }

            .preview-images img:hover {
              opacity: 1;
            }

            .active-preview {
              border: 2px solid #fff;
            }

            .caption {
              text-align: center;
              color: white;
              font-size: 18px;
              margin-top: 10px;
            }

            .prev, .next {
              position: absolute;
              top: 50%;
              transform: translateY(-50%);
              background-color: rgba(0, 0, 0, 0.5);
              color: white;
              padding: 10px;
              border: none;
              cursor: pointer;
              font-size: 18px;
              z-index: 1;
            }

            .prev { left: 10px; }
            .next { right: 10px; }
            </style>
        `
        
        allSliderHTML += `
            <div class="slider-container" id="slider${i}">
            <div class="slide-number" id="slideNumber${i}">1 / ${validImageCount}</div>
            <img id="mainImage${i}" class="main-image" src="${mainImage}" alt="ë©”ì¸ ì´ë¯¸ì§€">
            <div class="preview-images">
                ${previewImagesHTML.trim()}
            </div>
            <div class="caption" id="caption${i}">${captions[0] || "ìº¡ì…˜ ì˜ˆì‹œì…ë‹ˆë‹¤."}</div>
            <button class="prev" onclick="moveSlide(${i}, -1)">&#10094;</button>
            <button class="next" onclick="moveSlide(${i}, 1)">&#10095;</button>
            </div>\n `;

        let allImageVarDeclarations = "";
        for (let i = 1; i <= slideCount; i++) {
          const imageInputs = document.querySelectorAll(`#slide-group-${i} .image-input`);
          const captionInputs = document.querySelectorAll(`#slide-group-${i} .caption-input`);

          const imageUrls = Array.from(imageInputs).map(input => input.value.trim());
          const captions = Array.from(captionInputs).map(input => input.value.trim());

          const imageDataArray = [];

          imageUrls.forEach((url, idx) => {
            if (!url) return;
            const caption = captions[idx] || "ìº¡ì…˜ ì—†ìŒ";
            imageDataArray.push(`  {src: "${url}", caption: "${caption}"}`);
          });

          const imageVar = `var images${i} = [\n${imageDataArray.join(",\n")}\n];\n`;
          allImageVarDeclarations += imageVar;
        }      
       
       
       allScriptHTML = allImageVarDeclarations;
       const reptext1 = "`#slider${sliderNumber} .preview-images img`"
       const reptext2 ="`slideNumber${sliderNumber}`"
       const reptext4 ="`images${sliderNumber}`"
       const reptext5 ="`mainImage${sliderNumber}`"
       const reptext6 ="`caption${sliderNumber}`"
       const reptext7 ="`${currentIndex + 1} / ${totalSlides}`"
       const reptext8 ="`images${sliderNumber}`"
       const reptext9 ="`mainImage${sliderNumber}`"
       const reptext10 ="`slideNumber${sliderNumber}`"
       const reptext11 ="`slideNumber${sliderNumber}`"
       const reptext12 ="`slideNumber${sliderNumber}`"
       const reptext13 ="`slideNumber${sliderNumber}`"
       const reptext14 ="`slideNumber${sliderNumber}`"
       
       
       lastHTML = `
         // ê° ìŠ¬ë¼ì´ë“œì˜ í˜„ì¬ ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•˜ëŠ” ë°°ì—´
            const currentIndexes = {};

            // ë©”ì¸ ì´ë¯¸ì§€ë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
            function changeImage(sliderNumber, index) {
                currentIndexes[sliderNumber] = index;
                const imageList = window[${reptext4}];
                document.getElementById(${reptext5}).src = imageList[index].src;
                document.getElementById(${reptext6}).textContent = imageList[index].caption;
                updateSlideNumber(sliderNumber, index, imageList.length);
                updatePreview(sliderNumber, index);
            }

            // ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ í™œì„±í™” ìƒíƒœ ë³€ê²½ í•¨ìˆ˜
            function updatePreview(sliderNumber, index) {
                const previews = document.querySelectorAll(${reptext1});
                previews.forEach((preview, i) => {
                    preview.classList.toggle('active-preview', i === index);
                });
            }

            // ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function updateSlideNumber(sliderNumber, currentIndex, totalSlides) {
                const el = document.getElementById(${reptext2});
                if (el) el.textContent = ${reptext7};
            }

            // ìŠ¬ë¼ì´ë“œ ì´ë™ í•¨ìˆ˜
            function moveSlide(sliderNumber, step) {
                const imageList = window[${reptext8}];
                if (!imageList) return;

                const len = imageList.length;
                if (!currentIndexes.hasOwnProperty(sliderNumber)) currentIndexes[sliderNumber] = 0;

                currentIndexes[sliderNumber] += step;
                if (currentIndexes[sliderNumber] < 0) currentIndexes[sliderNumber] = len - 1;
                if (currentIndexes[sliderNumber] >= len) currentIndexes[sliderNumber] = 0;

                const idx = currentIndexes[sliderNumber];
                document.getElementById(${reptext5}).src = imageList[idx].src;
                document.getElementById(${reptext6}).textContent = imageList[idx].caption;
                updateSlideNumber(sliderNumber, idx, len);
                updatePreview(sliderNumber, idx);
            }

            // ìë™ ìŠ¬ë¼ì´ë“œ ì„¤ì • í•¨ìˆ˜ (ìŠ¬ë¼ì´ë“œ ìˆ˜ì— ë”°ë¼ ë™ì ìœ¼ë¡œ)
            function setupAutoSlides(slideCount) {
                for (let i = 1; i <= slideCount; i++) {
                    setInterval(() => {
                        moveSlide(i, 1);
                    }, 5000);
                }
            }
                setupAutoSlides(${slideCount});

   
       `
       
     

            console.log("allScriptHTML :" + allScriptHTML)
        }
         const htmlTemplate = basicHTML + allSliderHTML;
         const reptext3 = "/script"
           const fullScript = `
          <script>
            ${allScriptHTML}
            ${lastHTML}
          <${reptext3}>
          `
        // const htmlTemplate = allSliderHTML+allScriptHTML;
  
  
        // const finalHTML = htmlTemplate + scriptTemplate;
        
        // ë³´ì—¬ì£¼ê¸°
        codeResult.innerText = htmlTemplate + fullScript;
        codeResult.style.display = "block";

        // ë³µì‚¬ ë²„íŠ¼ í‘œì‹œ
        const copyBtn = document.getElementById("copyBtn");
        copyBtn.style.display = "inline-block";

        // ë³µì‚¬ ê¸°ëŠ¥ ì—°ê²°
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(codeResult.innerText).then(() => {
            copyBtn.textContent = "ë³µì‚¬ ì™„ë£Œ!";
            setTimeout(() => {
              copyBtn.textContent = "ì „ì²´ ë³µì‚¬";
            }, 1500);
          }).catch(err => {
            alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: " + err);
          });
        };
    });
    
    // const copyBtn = document.getElementById("copyBtn");
    // copyBtn.style.display = "inline-block"; // ì½”ë“œ ìƒì„± ì‹œ ë²„íŠ¼ í‘œì‹œ
    // copyBtn.onclick = () => {
    //   const text = codeResult.innerText;
    //   navigator.clipboard.writeText(text).then(() => {
    //     copyBtn.textContent = "ë³µì‚¬ ì™„ë£Œ!";
    //     setTimeout(() => (copyBtn.textContent = "ì „ì²´ ë³µì‚¬"), 2000);
    //   }).catch(err => {
    //     alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: " + err);
    //   });
    // };
    
    
  </script>
</body>
</html>
